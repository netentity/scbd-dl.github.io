/* 
* --------------------
* | adEngine         |
* --------------------
* @version: 2.0
* @author: A.I Raju
* @copyright: 2025
* @License: MIT
*/ 
var adEngine={Status:{Ads:!1,popBanner:!1},Config:{refreshTime:3e4,forceDefaultRefreshTime:!1,popBannerEnable:!0,popBannerDelay:1e3,popBannerMaxDisplay:0,popBannerDisplayAfterClose:3e4,set:function(e){for(key in e)adEngine.Config[key]=e[key]}},Ads:{},Placement:{},Serve:{horizontal:[],vertical:[],box:[],add:function(e,n){return""!=e&&""!=n&&void 0!==e&&void 0!==n&&(-1===adEngine.Serve[e].indexOf(n)&&(adEngine.Serve[e].push(n),!0))},remove:function(e,n){if(""==e||""==n||void 0===e||void 0===n)return!1;var t=adEngine.Serve[e].indexOf(n);return t>-1&&(adEngine.Serve[e].splice(t,1),!0)},has:function(e,n){return""!=e&&""!=n&&void 0!==e&&void 0!==n&&adEngine.Serve[e].indexOf(n)>-1}},Cookie:{get:function(e){let n=e+"=",t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let a=t[e];for(;" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(n))return a.substring(n.length,a.length)}return""},set:function(e,n,t=7,a="/",i=!1){const r=new Date;r.setTime(r.getTime()+24*t*60*60*1e3);let o="expires="+r.toUTCString();!1===i&&(i=new URL(document.location).host.replace("www.","")),document.cookie=e+"="+n+";"+o+";path=/;domain="+i+";Secure"},has:function(e){return!!this.get(e)}},Url:{get:function(e){var n,t,a=window.location.search.substring(1).split("&");for(t=0;t<a.length;t++)if((n=a[t].split("="))[0]===e)return void 0!==n[1]&&decodeURIComponent(n[1]);return!1},getCleanUrl:function(e=!1){var n=new URL(!1===e?window.location.href:e);return n.href.replace(n.hash,"").replace(n.search,"")},currentUrl:function(){return window.location.href},parseUrl:function(e=!1){return e?new URL(e):window.location},encode:function(e){return""!==e&&encodeURIComponent(e)},decode:function(e){return""!==e&&decodeURIComponent(e)},go:function(e){if(""===e)return!1;window.location=e},isValidUrl:function(e){return null!==e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)},getValidUrl:function(e){("//"===e.substring(0,2)&&(e="http:"+e),"/"===e[0]&&(e="http:/"+e),"http://"===e.substring(0,7)||"https://"===e.substring(0,8))||(e="http://"+this.parseUrl(this.currentUrl()).hostname+"/"+e);return e}},eventTracking:{send:function(e){"function"==typeof gtag&&gtag("event",e,{event_name:e})},trackIframeClicks:function(){var e=0,n=0;document.addEventListener("mouseover",(function(t){var a=t.target.tagName;"IFRAME"==a&&(n=1),document.addEventListener("mouseout",(function(t){"IFRAME"===t.target.tagName&&(e=0,n=0)})),window.addEventListener("blur",(function(t){"IFRAME"==a&&1==n&&0==e&&(e=1,adEngine.eventTracking.send("AE_iframe_click"))})),"IFRAME"!==a&&window.focus(),window.focus()}))}},adRequest:{getAds:function(e){if(""==e)return!1;var n;(n=new XMLHttpRequest).onreadystatechange=function(){if(4==n.readyState&&200==n.status){var e=JSON.parse(n.responseText);e.hasOwnProperty("Ads")&&0!==e.Ads.length?(adEngine.Status.Ads=!0,adEngine.Ads=e.Ads,adEngine.eventTracking.send("AE_getAds")):adEngine.Status.Ads=!1}},n.open("GET",e,!0),n.send()}},Render:{getPlacement:function(){var e=document.querySelectorAll(".adEngine");0!==e.length&&(adEngine.Placement.total=e.length,adEngine.Placement.hasOwnProperty("ids")||(adEngine.Placement.ids=[]),adEngine.Placement.hasOwnProperty("type")||(adEngine.Placement.type=[]),e.forEach((function(e,n){if(e.hasAttribute("data-type")){var t=e.getAttribute("data-type");if(-1===adEngine.Placement.type.indexOf(t)&&adEngine.Placement.type.push(t),!e.hasAttribute("id")){var a="adEngine_placement_"+(n+1);-1===adEngine.Placement.ids.indexOf(a)&&(e.id=a,adEngine.Placement.ids.push(a))}}})))},renderPlacement:function(){adEngine.Placement.ids.forEach((function(e,n){adEngine.Render.displayAd(e)}))},displayAd:function(e){var n=document.querySelector("#"+e);if(n&&n.hasAttribute("data-type")){var t=n.getAttribute("data-type");if(adEngine.Ads.hasOwnProperty(t)){var a=adEngine.Render.selectAd(t,n);a&&adEngine.Render.createAdFrame(a,n,e,t)}}},selectAd:function(e,n){var t=n.parentNode.offsetWidth>120?n.parentNode.offsetWidth:window.innerWidth,a=function(e=1){var n=Math.round(Math.random()*e);return void 0===n?a(e):n};if(!(adEngine.Ads.hasOwnProperty(e)&&adEngine.Ads[e].length>0))return!1;var i=function(e,n,t){var r=adEngine.Ads[e][Math.round(Math.random()*adEngine.Ads[e].length)];if(""==r||void 0===r)return i(e,n,t);if(r.width>=t){var o=[];for(let n=0;n<adEngine.Ads[e].length;n++){var d=adEngine.Ads[e][n];d.width<=t&&o.push(d)}return 0!==o.length&&(1===o.length?o[0]:o[a(o.length)])}return r};if(adEngine.Ads[e].length===adEngine.Serve[e].length)return i(e,n,t);for(let a=0;a<adEngine.Ads[e].length;a++){var r=adEngine.Ads[e][a];if(r.width>=t){if(!adEngine.Serve.has(e,r.id))return adEngine.Serve.add(e,r.id),i(e,n,t)}else if(!adEngine.Serve.has(e,r.id))return adEngine.Serve.add(e,r.id),r}},createAdFrame:function(e,n,t,a){var i;n.innerHTML="",n.setAttribute("style","background-color: transparent;width:"+e.width+"px !important;height:"+e.height+"px !important;margin:auto !important;"),n.setAttribute("width",e.width),n.setAttribute("height",e.height),n.setAttribute("data-width",e.width),n.setAttribute("data-height",e.height),n.setAttribute("data-ads-id",e.id),i=e.hasOwnProperty("refreshTime")?e.refreshTime:adEngine.Config.refreshTime,adEngine.Config.forceDefaultRefreshTime&&(i=adEngine.Config.refreshTime);var r=`<!doctype html><html lang="en"><head><title>${document.title}</title><meta charset="UTF-8" /><meta name="description" content="${document.title}" /><style>*{padding: 0 !important;margin:0 !important;box-sizing: border-box;font-family: "Open Sans", "Roboto", "Rubik", sans-serif}.ads-by{font-weight: bold;position:absolute;top:0;right:0;padding: 2px 5px !important;font-size:10px;background:#FFE31A;color:#000;border-bottom-left-radius: 5px;box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);text-decoration: none !important;cursor: pointer;transition: all 0.3s;z-index:999999999}.ads-by:hover::before{content: "Ad served by";margin-right: 3px;font-weight: normal}</style></head><body><div class="ads-by">AE</div>${e.ad_code}</body><script>window.addEventListener('DOMContentLoaded', () => {parent.adEngine.eventTracking.send( "AE_Impression" );var adEngineInterval = setInterval(()=>{clearInterval(adEngineInterval);parent.adEngine.eventTracking.send( "AE_Refresh" );parent.adEngine.Render.displayAd("${t}");}, ${i});});<\/script></html>`,o=document.createElement("iframe");o.setAttribute("src",""),o.setAttribute("srcDoc",r),o.setAttribute("style","width:"+e.width+"px !important;height:"+e.height+"px !important;border:0px;padding:0;overflow:hidden;background-color:#f1f1f120;"),o.setAttribute("data-ads-by",e.name),o.setAttribute("data-type",a),o.setAttribute("scrolling","off"),o.setAttribute("frameborder","0"),n.appendChild(o)},popBanner:function(){var e=document.createElement("div");e.id="adEnginePopBanner",e.innerHTML='<div style="height:auto;width:auto;min-width:250px;position:fixed;bottom:0;right:0;margin-right:0px;margin-bottom:0px;text-align:center;"><div style="font-faimily:arial;font-weight:bold;text-align:center;background:red;color:#fff;height:20px;line-height:20px;font-size:11px;width:55px;margin:auto;border-top-right-radius:3px;border-top-left-radius:3px;cursor:pointer;font-family:"Open Sans", "Roboto", "Rubik", sans-serif;" onclick="adEngine.Render.popBannerClose()"><svg xmlns="http://www.w3.org/2000/svg" style="width:11px !important;height:11px !important;margin-top:-2px;" fill="currentColor" class="bi bi-x-square-fill" viewBox="0 0 16 16"><path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm3.354 4.646L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708"/></svg> Close</div><div style="display:block;margin:0px !important;" class="adEngine" data-type="box" id="popBanner_1"></div></div>',document.body.appendChild(e),adEngine.Render.displayAd("popBanner_1")},popBannerDisplay:function(){if(adEngine.Config.popBannerEnable)if(adEngine.Config.popBannerDelay>0)var e=setInterval((()=>{clearInterval(e),adEngine.Render.popBanner(),adEngine.Cookie.set("popBanner",1,1),adEngine.Status.popBanner=!0}),adEngine.Config.popBannerDelay);else adEngine.Render.popBanner(),adEngine.Status.popBanner=!0,adEngine.Cookie.set("popBanner",1,1)},popBannerClose:function(){document.querySelector("#adEnginePopBanner").addEventListener("click",(()=>{document.querySelector("#adEnginePopBanner").remove(),adEngine.eventTracking.send("AE_PopBannerClosed"),adEngine.Status.popBanner=!1;var e=adEngine.Cookie.has("popBanner")?adEngine.Cookie.get("popBanner"):0;if(e=parseInt(e),adEngine.Config.popBannerEnable&&(0==adEngine.Config.popBannerMaxDisplay||e!==adEngine.Config.popBannerMaxDisplay))var n=setInterval((()=>{clearInterval(n),adEngine.Render.popBanner(),adEngine.Status.popBanner=!0,adEngine.Cookie.set("popBanner",e+1,1)}),adEngine.Config.popBannerDisplayAfterClose)}))}},start:function(){adEngine.Render.getPlacement();var e=setInterval((function(){!0===adEngine.Status.Ads&&(clearInterval(e),adEngine.eventTracking.trackIframeClicks(),adEngine.Render.renderPlacement(),adEngine.Render.popBannerDisplay())}),100)}};
